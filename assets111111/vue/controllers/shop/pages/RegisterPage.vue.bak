<!--
CSS 引用说明：
1. 全局样式：在 src/main.ts 中自动加载
   - src/assets/main.css (导入 src/assets/base.css)
     - @tailwind base, components, utilities (Tailwind CSS)
     - 全局 CSS 变量 (--color-*, --section-gap, --category-width 等)
   - Element Plus 样式 (element-plus/dist/index.css)
2. 页面局部样式：该文件底部的 <style scoped> 块
3. 导入的子组件样式：由各子组件的 <style scoped> 块提供
-->
<template>
  <div class="login-page register-clone">
    <!-- 使用登录注册专用的头部 -->
    <LoginRegistorHeader />

    <!-- Main hero copied from LoginPage; login card replaced with register card -->
    <main class="login-main">
      <div class="login-hero-wrap">
        <section class="login-hero">
          <transition-group name="fade" tag="div" class="login-hero__stage">
            <img
              v-for="(src, i) in slides"
              :key="src + ':' + i + ':' + index"
              v-show="i === index"
              class="login-hero__image"
              :src="src"
              :alt="t('login.altBanner')"
              @error="onHeroError"
            />
          </transition-group>

          <div class="login-hero__inner">
            <button class="login-hero__arrow" type="button" :aria-label="t('register.prevSlide')" @click="prev">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <circle
                  cx="12"
                  cy="12"
                  r="11"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.3"
                />
                <path
                  d="M13.8 8.5 10.3 12l3.5 3.5"
                  fill="none"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.6"
                />
              </svg>
            </button>
            <button
              class="login-hero__arrow login-hero__arrow--right"
              type="button"
              :aria-label="t('register.nextSlide')"
              @click="next"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <circle
                  cx="12"
                  cy="12"
                  r="11"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.3"
                />
                <path
                  d="M10.2 8.5 13.7 12l-3.5 3.5"
                  fill="none"
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.6"
                />
              </svg>
            </button>

            <!-- Register Card (matches saleyee.com/register.html layout) -->
            <div class="register-card">
              <div class="register-card__tab">{{ t('register.title') }}</div>

              <!-- Username -->
              <div class="reg-field">
                <input
                  id="register-username"
                  v-model="form.username"
                  class="reg-input"
                  type="text"
                  :placeholder="t('register.usernamePlaceholder')"
                  autocomplete="username"
                />
              </div>

              <!-- Password -->
              <div class="reg-field">
                <div class="reg-input-wrap">
                  <button
                    type="button"
                    class="reg-eye"
                    @click="showPwd = !showPwd"
                    :aria-label="t('register.togglePassword')"
                  >
                    <img :src="showPwd ? visibleIcon : hiddenIcon" alt="" />
                  </button>
                  <input
                    id="register-password"
                    v-model="form.password"
                    class="reg-input reg-input--with-eye"
                    :type="showPwd ? 'text' : 'password'"
                    :placeholder="t('register.passwordPlaceholder')"
                    autocomplete="new-password"
                  />
                </div>
                <div class="reg-hint">{{ t('register.passwordHint') }}</div>
              </div>

              <!-- Confirm Password -->
              <div class="reg-field">
                <div class="reg-input-wrap">
                  <button
                    type="button"
                    class="reg-eye"
                    @click="showConfirm = !showConfirm"
                    :aria-label="t('register.toggleConfirmPassword')"
                  >
                    <img :src="showConfirm ? visibleIcon : hiddenIcon" alt="" />
                  </button>
                  <input
                    id="register-confirm"
                    v-model="form.confirm"
                    class="reg-input reg-input--with-eye"
                    :type="showConfirm ? 'text' : 'password'"
                    :placeholder="t('register.confirmPlaceholder')"
                    autocomplete="new-password"
                  />
                </div>
              </div>

              <!-- Phone -->
              <div class="reg-field">
                <input
                  id="register-phone"
                  v-model="form.phone"
                  class="reg-input"
                  type="text"
                  :placeholder="t('register.phonePlaceholder')"
                  autocomplete="tel"
                  inputmode="tel"
                />
              </div>

              <!-- SMS code -->
              <div class="reg-row reg-row--code">
                <input
                  id="register-sms"
                  v-model="form.sms"
                  class="reg-input"
                  type="text"
                  maxlength="4"
                  :placeholder="t('register.smsPlaceholder')"
                  autocomplete="one-time-code"
                  inputmode="numeric"
                />
                <button 
                  type="button" 
                  class="reg-code" 
                  @click="sendCode"
                  :disabled="smsCodeSending || smsCodeCountdown > 0"
                >
                  <template v-if="smsCodeCountdown > 0">
                    {{ smsCodeCountdown }}秒后重试
                  </template>
                  <template v-else-if="smsCodeSending">
                    发送中...
                  </template>
                  <template v-else>
                    {{ t('register.getSmsCode') }}
                  </template>
                </button>
              </div>

              <!-- Agreement -->
              <div class="reg-agree">
                <input id="agree" type="checkbox" v-model="form.agree" />
                <label for="agree">
                  {{ t('register.agreePrefix') }}
                  <a 
                    v-if="termsOfServiceResource" 
                    class="hover:underline" 
                    :href="termsOfServiceResource?.helpFaqId ? '/help-center?faqid=' + termsOfServiceResource.helpFaqId : ''"
                    target="_blank"
                    rel="noreferrer"
                    v-text="currentLang === 'en' && termsOfServiceResource?.titleEn ? termsOfServiceResource.titleEn : termsOfServiceResource?.title || termsOfServiceResource?.title"
                  ></a>
                  -
                  <a 
                    v-if="privacyPolicyResource" 
                    class="hover:underline" 
                    :href="privacyPolicyResource?.helpFaqId ? '/help-center?faqid=' + privacyPolicyResource.helpFaqId : ''"
                    target="_blank"
                    rel="noreferrer"
                    v-text="currentLang === 'en' && privacyPolicyResource?.titleEn ? privacyPolicyResource.titleEn : privacyPolicyResource?.title || privacyPolicyResource?.title"
                  ></a>
                </label>
              </div>

              <!-- Next button -->
              <button type="button" class="reg-submit" @click="nextStep" :disabled="isSubmitting">
                <span v-if="isSubmitting" class="btn-loading"></span>
                {{ isSubmitting ? (currentLang === 'zh-CN' ? '正在注册...' : 'Registering...') : t('register.nextStep') }}
              </button>

              <!-- Login link -->
              <div class="reg-login">
                <a href="/login">{{ t('register.hasAccount') }}<span>{{ t('register.login') }}</span></a>
              </div>
            </div>

            <div class="login-hero__dots" aria-hidden="true">
              <span
                v-for="(s, i) in slides"
                :key="'dot-' + i"
                :class="i === index ? 'is-active' : ''"
                @click="go(i)"
              ></span>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- 使用公用的网站底部 -->
    <SiteFooter />
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted, onBeforeUnmount, reactive, computed } from 'vue'
import { ElMessage } from 'element-plus'
import LoginRegistorHeader from '../components/LoginRegistorHeader.vue'
import SiteFooter from '../components/SiteFooter.vue'
import encryptionService from '../data/encryption-service.js'
import apiSignature from '../services/apiSignature.js'

// 获取store实例
const store = window.vueStore

// 页面翻译数据
const translations = ref({})

// 当前语言 - 使用ref以便能响应事件更新
const currentLang = ref(localStorage.getItem('app.lang') || 'zh-CN')

// 隐私协议资源 (position为privacyPolicy, positiontype为legalDocuments)
const privacyPolicyResource = computed(() => {
  if (store && store.getters && store.getters.privacyPolicyResources) {
    const resources = store.getters.privacyPolicyResources
    if (Array.isArray(resources) && resources.length > 0) {
      return resources.find(resource =>
        resource.position === 'privacyPolicy' &&
        resource.positiontype === 'legalDocuments'
      )
    }
  }
  return null
})

// 服务条款资源 (position为termsOfService, positiontype为legalDocuments)
const termsOfServiceResource = computed(() => {
  if (store && store.getters && store.getters.termsOfServiceResources) {
    const resources = store.getters.termsOfServiceResources
    if (Array.isArray(resources) && resources.length > 0) {
      return resources.find(resource =>
        resource.position === 'termsOfService' &&
        resource.positiontype === 'legalDocuments'
      )
    }
  }
  return null
})

// 加载翻译文件
const loadTranslations = async () => {
  try {
    const response = await fetch('/frondend/lang/RegisterPage.json')
    const data = await response.json()
    translations.value = data
  } catch (error) {
    console.error('Failed to load translations:', error)
  }
}

// 翻译函数 - 直接从页面特定的JSON文件读取
const t = (key) => {
  // 获取当前语言，优先从localStorage获取，否则使用默认值
  const lang = localStorage.getItem('app.lang') || 'zh-CN'
  
  // 从页面特定的翻译文件中获取翻译
  if (translations.value[lang] && translations.value[lang][key]) {
    return translations.value[lang][key]
  }
  
  // 如果没有找到翻译，返回键名
  return key
}

// 更新页面标题
const updatePageTitle = () => {
  const title = t('pageTitle')
  if (title && title !== 'pageTitle') {
    document.title = title
  }
}

// 监听语言变化事件
const handleLangChange = (event) => {
  if (event.detail && event.detail.lang) {
    currentLang.value = event.detail.lang
  }
  // 重新加载翻译以确保语言切换时更新
  loadTranslations()
  // 更新页面标题
  updatePageTitle()
}

// hero carousel (copied from LoginPage)
const slides = [
  '/frondend/images/RegisterPage/banner1.png',
  '/frondend/images/RegisterPage/banner2.jpg',
  '/frondend/images/RegisterPage/fallback_banner.jpg',
]
const index = ref(0)
let timer
const fallbackHero =
  '/frondend/images/RegisterPage/fallback_banner.jpg'
function onHeroError(event) {
  const target = event.target
  if (target && target.src !== fallbackHero) target.src = fallbackHero
}
function startAuto() {
  stopAuto()
  if (slides.length > 1)
    timer = window.setInterval(() => (index.value = (index.value + 1) % slides.length), 4500)
}
function stopAuto() {
  if (timer) {
    window.clearInterval(timer)
    timer = undefined
  }
}
function prev() {
  index.value = (index.value - 1 + slides.length) % slides.length
}
function next() {
  index.value = (index.value + 1) % slides.length
}
function go(i) {
  index.value = i % slides.length
}

onMounted(() => {
  // 检查是否已登录，如果已登录则跳转到首页
  const store = window.vueStore
  if (store && store.state && store.state.isLoggedIn) {
    window.location.href = '/'
    return
  }
  
  // 初始加载翻译
  loadTranslations().then(() => {
    // 翻译加载完成后设置标题
    updatePageTitle()
  })
  startAuto()
  
  // 监听语言变化事件
  window.addEventListener('languagechange', handleLangChange)
  
  // 加载公共资源数据
  if (store && store.dispatch) {
    // 检查是否需要加载数据
    const lastUpdated = store.state.publicResources?.lastUpdated
    let shouldLoad = false
    
    if (!lastUpdated) {
      shouldLoad = true
    } else {
      const lastUpdatedTime = new Date(lastUpdated)
      const now = new Date()
      const diffMinutes = (now - lastUpdatedTime) / (1000 * 60)
      shouldLoad = diffMinutes >= 5
    }
    
    // 如果需要加载数据，则一次性加载所有公共资源
    if (shouldLoad) {
      store.dispatch('loadPublicResources')
    }
  }
})

onBeforeUnmount(() => {
  window.removeEventListener('languagechange', handleLangChange)
  // 清除倒计时定时器
  if (countdownTimer) {
    clearInterval(countdownTimer)
    countdownTimer = null
  }
})

onUnmounted(() => {
  stopAuto()
  // 清除倒计时定时器
  if (countdownTimer) {
    clearInterval(countdownTimer)
    countdownTimer = null
  }
})

// register form state
const form = reactive({
  username: '',
  area: '86',
  phone: '',
  password: '',
  confirm: '',
  sms: '',
  invite: '',
  agree: false,
})
const showPwd = ref(false)
const showConfirm = ref(false)
const visibleIcon = '/frondend/images/RegisterPage/visible.png'
const hiddenIcon = '/frondend/images/RegisterPage/invisible.png'
const isSubmitting = ref(false)
const smsCodeSending = ref(false)  // 是否正在发送验证码
const smsCodeCountdown = ref(0)  // 验证码倒计时
let countdownTimer = null

// 发送短信验证码
async function sendCode() {
  // 验证手机号
  if (!form.phone) {
    ElMessage.warning('请输入手机号')
    return
  }
  
  // 验证手机号格式
  if (!/^1[3-9]\d{9}$/.test(form.phone)) {
    ElMessage.warning('手机号格式不正确')
    return
  }
  
  smsCodeSending.value = true
  
  try {
    const response = await fetch('/shop/api/auth/send-sms-code', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        phone: form.phone
      })
    })
    
    const data = await response.json()
    
    if (data.success) {
      ElMessage.success({
        message: currentLang.value === 'en' ? data.messageEn : data.message,
        duration: 3000
      })
      // 启动倒计时（60秒）
      smsCodeCountdown.value = 60
      countdownTimer = setInterval(() => {
        smsCodeCountdown.value--
        if (smsCodeCountdown.value <= 0) {
          clearInterval(countdownTimer)
          countdownTimer = null
        }
      }, 1000)
    } else {
      ElMessage.error({
        message: currentLang.value === 'en' ? data.messageEn : data.message,
        duration: 5000,
        showClose: true
      })
    }
  } catch (error) {
    console.error('发送短信失败:', error)
    ElMessage.error('发送失败，请稍后重试')
  } finally {
    smsCodeSending.value = false
  }
}

async function nextStep() {
  // 验证必填字段
  if (!form.username || !form.phone || !form.password || !form.confirm || !form.agree) {
    ElMessage.warning('请完整填写并同意协议')
    return
  }
  
  // 验证密码一致性
  if (form.password !== form.confirm) {
    ElMessage.warning('两次输入的密码不一致')
    return
  }
  
  // 验证密码长度
  if (form.password.length < 8) {
    ElMessage.warning('密码8位数以上')
    return
  }
  
  if (isSubmitting.value) {
    return
  }
  
  isSubmitting.value = true
  
  try {
    // 准备注册数据，加密整个对象
    const registerData = encryptionService.encryptObject({
      username: form.username,
      password: form.password,
      confirm: form.confirm,
      phone: form.phone,
      sms: form.sms,
      invite: form.invite
    })
    
    // 调用注册 API
    const response = await fetch('/shop/api/auth/register', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(registerData)
    })
    
    const data = await response.json()
    
    if (data.success) {
      // 注册成功，保存用户信息和API签名密钥
      if (store && store.commit) {
        store.commit('SET_USER', data.user)
      }
      
      // 保存API签名密钥
      if (data.apiSignKey) {
        apiSignature.setKey(data.apiSignKey)
      }
      
      ElMessage.success({
        message: currentLang.value === 'en' ? data.messageEn : data.message,
        duration: 2000
      })
      
      // 注册成功后跳转到个人中心
      setTimeout(() => {
        window.location.href = '/user-center'
      }, 1000)
    } else {
      ElMessage.error({
        message: currentLang.value === 'en' ? data.messageEn : data.message,
        duration: 5000,
        showClose: true
      })
    }
  } catch (error) {
    console.error('注册错误:', error)
    ElMessage.error('注册失败，请稍后重试')
  } finally {
    isSubmitting.value = false
  }
}

const areaOptions = [
  { value: '86', label: '+86 中国' },
  { value: '1', label: '+1 美国 和 加拿大' },
  { value: '7', label: '+7 俄罗斯 和 哈萨克' },
  { value: '20', label: '+20 埃及' },
  { value: '27', label: '+27 南非' },
  { value: '30', label: '+30 希腊' },
  { value: '31', label: '+31 荷' },
  { value: '32', label: '+32 比利时' },
  { value: '33', label: '+33 法国' },
  { value: '34', label: '+34 西班牙' },
  { value: '36', label: '+36 匈牙利' },
  { value: '39', label: '+39 意大利' },
  { value: '40', label: '+40 罗马尼亚' },
  { value: '41', label: '+41 瑞士' },
  { value: '43', label: '+43 奥地利' },
  { value: '44', label: '+44 英国' },
  { value: '45', label: '+45 丹麦' },
  { value: '46', label: '+46 瑞典' },
  { value: '47', label: '+47 挪威' },
  { value: '48', label: '+48 波兰' },
  { value: '49', label: '+49 德国' },
  { value: '51', label: '+51 秘鲁' },
  { value: '52', label: '+52 墨西哥' },
  { value: '53', label: '+53 古巴' },
  { value: '54', label: '+54 阿根廷' },
  { value: '55', label: '+55 巴西' },
  { value: '56', label: '+56 智利' },
  { value: '57', label: '+57 哥伦比亚' },
  { value: '58', label: '+58 委内瑞拉' },
  { value: '60', label: '+60 马来西亚' },
  { value: '61', label: '+61 澳洲' },
  { value: '62', label: '+62 印度尼西亚' },
  { value: '63', label: '+63 菲律宾' },
  { value: '64', label: '+64 新西兰' },
  { value: '65', label: '+65 新加坡' },
  { value: '66', label: '+66 泰国' },
  { value: '81', label: '+81 日本' },
  { value: '82', label: '+82 韩国' },
  { value: '84', label: '+84 越南' },
  { value: '90', label: '+90 土耳其' },
  { value: '91', label: '+91 印度' },
  { value: '92', label: '+92 巴基斯坦' },
  { value: '93', label: '+93 阿富汗' },
  { value: '94', label: '+94 斯里兰卡' },
  { value: '95', label: '+95 缅甸' },
  { value: '98', label: '+98 伊朗' },
  { value: '211', label: '+211 南苏丹' },
  { value: '212', label: '+212 摩洛哥' },
  { value: '213', label: '+213 阿尔及利亚' },
  { value: '216', label: '+216 突尼斯' },
  { value: '218', label: '+218 利比亚' },
  { value: '220', label: '+220 冈比亚' },
  { value: '221', label: '+221 塞内加尔' },
  { value: '222', label: '+222 毛里塔尼亚' },
  { value: '223', label: '+223 马里共和国' },
  { value: '224', label: '+245 几内亚比绍' },
  { value: '225', label: '+225 科特迪瓦' },
  { value: '226', label: '+226 布基纳法索' },
  { value: '227', label: '+227 尼日' },
  { value: '228', label: '+228 多哥' },
  { value: '229', label: '+229 贝宁' },
  { value: '230', label: '+230 毛里求斯' },
  { value: '231', label: '+231 利比里亚' },
  { value: '232', label: '+232 狮子山共和国' },
  { value: '233', label: '+233 加纳' },
  { value: '234', label: '+234 尼日利亚' },
  { value: '235', label: '+235 查德' },
  { value: '236', label: '+236 中非共和国' },
  { value: '237', label: '+237 喀麦隆' },
  { value: '238', label: '+238 佛得角' },
  { value: '239', label: '+239 圣多美普林西比' },
  { value: '240', label: '+240 赤道几内亚' },
  { value: '241', label: '+241 加蓬' },
  { value: '242', label: '+242 刚果共和国' },
  { value: '243', label: '+243 刚果民主共和国' },
  { value: '244', label: '+244 安哥拉' },
  { value: '245', label: '+245 几内亚比绍' },
  { value: '247', label: '+247 阿森松岛' },
  { value: '248', label: '+248 塞舌尔' },
  { value: '249', label: '+249 苏丹' },
  { value: '250', label: '+250 卢旺达' },
  { value: '251', label: '+251 埃塞俄比亚' },
  { value: '252', label: '+252 索马里' },
  { value: '253', label: '+253 吉布提' },
  { value: '254', label: '+254 肯尼亚' },
  { value: '255', label: '+255 坦桑尼亚' },
  { value: '256', label: '+256 乌干达' },
  { value: '257', label: '+257 布隆迪' },
  { value: '258', label: '+258 莫桑比克' },
  { value: '260', label: '+260 赞比亚' },
  { value: '261', label: '+261 马达加斯加' },
  { value: '262', label: '+262 留尼旺' },
  { value: '263', label: '+263 津巴布韦' },
  { value: '264', label: '+264 纳米比亚' },
  { value: '265', label: '+265 马拉维' },
  { value: '266', label: '+266 莱索托' },
  { value: '267', label: '+267 博茨瓦纳' },
  { value: '268', label: '+268 斯威士兰' },
  { value: '269', label: '+269 科摩罗 和 马约特' },
  { value: '297', label: '+297 阿鲁巴 (荷兰王国)' },
  { value: '298', label: '+298 法罗群岛 (丹麦)' },
  { value: '299', label: '+299 格陵兰 (丹麦)' },
  { value: '350', label: '+350 直布罗陀 (英国)' },
  { value: '351', label: '+351 葡萄牙' },
  { value: '352', label: '+352 卢森堡' },
  { value: '353', label: '+353 爱尔兰共和国' },
  { value: '354', label: '+354 冰岛' },
  { value: '355', label: '+355 阿尔巴尼亚' },
  { value: '356', label: '+356 马耳他' },
  { value: '357', label: '+357 塞浦路斯' },
  { value: '358', label: '+358 芬兰' },
  { value: '359', label: '+359 保加利亚' },
  { value: '370', label: '+370 立陶宛' },
  { value: '371', label: '+371 拉脱维亚' },
  { value: '372', label: '+372 爱沙尼亚' },
  { value: '373', label: '+373 摩尔多瓦' },
  { value: '374', label: '+374 亚美尼亚' },
  { value: '375', label: '+375 白俄罗斯' },
  { value: '376', label: '+376 安道尔' },
  { value: '377', label: '+377 摩纳哥' },
  { value: '378', label: '+378 圣马力诺' },
  { value: '380', label: '+380 乌克兰' },
  { value: '381', label: '+381 塞尔维亚共和国' },
  { value: '382', label: '+382 黑山共和国' },
  { value: '385', label: '+385 克罗地亚' },
  { value: '386', label: '+386 斯洛文尼亚' },
  { value: '387', label: '+387 波斯尼亚与赫塞哥维纳' },
  { value: '389', label: '+389 马其顿' },
  { value: '420', label: '+420 捷克' },
  { value: '421', label: '+421 斯洛伐克' },
  { value: '423', label: '+423 列支敦士登' },
  { value: '501', label: '+501 伯利兹' },
  { value: '502', label: '+502 危地马拉' },
  { value: '503', label: '+503 萨尔瓦多' },
  { value: '504', label: '+504 洪都拉斯' },
  { value: '505', label: '+505 尼加拉瓜' },
  { value: '506', label: '+506 哥斯达黎加' },
  { value: '507', label: '+507 巴拿马' },
  { value: '508', label: '+508 圣皮耶与密克隆群岛 (法国)' },
  { value: '509', label: '+509 海地' },
  { value: '590', label: '+590 瓜德罗普岛 和 圣马丁岛(荷兰部分)' },
  { value: '591', label: '+591 玻利维亚' },
  { value: '592', label: '+592 圭亚那' },
  { value: '593', label: '+593 厄瓜多尔' },
  { value: '594', label: '+594 法属圭亚那 (法国)' },
  { value: '595', label: '+595 巴拉圭' },
  { value: '596', label: '+596 马提克 (法国)' },
  { value: '597', label: '+597 苏里南' },
  { value: '598', label: '+598 乌拉圭' },
  { value: '599', label: '+599 博内尔岛，圣尤斯特歇斯 和 库拉索 (荷兰王国)' },
  { value: '670', label: '+670 东帝汶' },
  { value: '673', label: '+673 文莱' },
  { value: '675', label: '+675 巴布亚新几内亚' },
  { value: '676', label: '+676 东加' },
  { value: '677', label: '+677 所罗门群岛' },
  { value: '678', label: '+678 瓦努阿图' },
  { value: '679', label: '+679 斐济' },
  { value: '680', label: '+680 帕劳' },
  { value: '682', label: '+682 库克群岛 (新西兰)' },
  { value: '685', label: '+685 萨摩亚' },
  { value: '686', label: '+686 基里巴斯' },
  { value: '687', label: '+687 新喀里多尼亚 (法国)' },
  { value: '689', label: '+689 法属波利尼西亚 (法国)' },
  { value: '852', label: '+852 中国香港' },
  { value: '853', label: '+853 中国澳门' },
  { value: '855', label: '+855 柬埔寨' },
  { value: '856', label: '+856 老挝' },
  { value: '880', label: '+880 孟加拉国' },
  { value: '886', label: '+886 中国台湾' },
  { value: '960', label: '+960 马尔代夫' },
  { value: '961', label: '+961 黎巴嫩' },
  { value: '962', label: '+962 约旦' },
  { value: '963', label: '+963 叙利亚' },
  { value: '964', label: '+964 伊拉克' },
  { value: '965', label: '+965 科威特' },
  { value: '966', label: '+966 沙特阿拉伯' },
  { value: '967', label: '+967 也门' },
  { value: '968', label: '+968 阿曼' },
  { value: '970', label: '+970 巴勒斯坦' },
  { value: '971', label: '+971 阿拉伯联合酋长国' },
  { value: '972', label: '+972 以色列' },
  { value: '973', label: '+973 巴林' },
  { value: '974', label: '+974 卡达' },
  { value: '975', label: '+975 不丹' },
  { value: '976', label: '+976 蒙古国' },
  { value: '977', label: '+977 尼泊尔' },
  { value: '992', label: '+992 塔吉克' },
  { value: '993', label: '+993 土库曼' },
  { value: '994', label: '+994 阿塞拜疆' },
  { value: '995', label: '+995 乔治亚' },
  { value: '996', label: '+996 吉尔吉斯' },
  { value: '998', label: '+998 乌兹别克' },
  { value: '1242', label: '+1242 巴哈马' },
  { value: '1246', label: '+1246 巴巴多斯' },
  { value: '1264', label: '+1264 安圭拉' },
  { value: '1268', label: '+1268 安提瓜和巴布达' },
  { value: '1284', label: '+1284 英属维尔京群岛 (英国)' },
  { value: '1340', label: '+1340 美属维尔京群岛 (美国)' },
  { value: '1345', label: '+1345 开曼群岛 (英国)' },
  { value: '1441', label: '+1441 百慕大 (英国)' },
  { value: '1473', label: '+1473 格林纳达' },
  { value: '1649', label: '+1649 土克凯可群岛 (英国)' },
  { value: '1664', label: '+1664 蒙塞拉特岛 (英国)' },
  { value: '1671', label: '+1671 关岛 (美国)' },
  { value: '1684', label: '+1684 美属萨摩亚 (美国)' },
  { value: '1758', label: '+1758 圣卢西亚' },
  { value: '1767', label: '+1767 多米尼克' },
  { value: '1784', label: '+1784 圣文森及格林纳丁' },
  { value: '1787', label: '+1787 波多黎各 (美国)' },
  { value: '1809', label: '+1809 多米尼加共和国' },
  { value: '1868', label: '+1868 特立尼达和多巴哥' },
  { value: '1869', label: '+1869 圣克里斯多福与尼维斯' },
  { value: '1876', label: '+1876 牙买加' },
]
</script>

<style scoped>
/* ====== Copied base styles from LoginPage ====== */
.login-page {
  min-height: 100vh;
  background-color: #ffffff;
  color: #2d2d2d;
  display: flex;
  flex-direction: column;
  font-family: 'PingFang SC', 'Microsoft YaHei', 'Helvetica Neue', Arial, sans-serif;
}
.login-container {
  width: 1200px;
  margin: 0 auto;
}
.login-hero-wrap {
  width: 100vw;
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;
}

/* Header 样式已移至 SiteHeader 组件 */

.login-main {
  padding: 36px 0 0px;
  flex: 1;
}
.login-hero {
  position: relative;
  height: 540px;
  border-radius: 0;
  overflow: hidden;
  box-shadow: 0 30px 60px rgba(0, 0, 0, 0.12);
}
.login-hero__stage {
  position: absolute;
  inset: 0;
}
.login-hero__image {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.login-hero::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    90deg,
    rgba(24, 8, 1, 0.68) 0%,
    rgba(24, 8, 1, 0.38) 44%,
    rgba(24, 8, 1, 0.08) 82%
  );
  pointer-events: none;
}
.login-hero__arrow {
  position: absolute;
  left: 34px;
  top: 50%;
  transform: translateY(-50%);
  width: 49px;
  height: 49px;
  border: none;
  background: transparent;
  color: #cbd5e1;
  z-index: 3;
  cursor: pointer;
}
.login-hero__arrow--right {
  left: auto;
  right: 34px;
}
.login-hero__arrow svg {
  width: 62%;
  height: 62%;
}
.login-hero__arrow:hover {
  color: #9ca3af;
}
.login-hero__dots {
  position: absolute;
  bottom: 26px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 12px;
  z-index: 3;
}
.login-hero__dots span {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.55);
  cursor: pointer;
}
.login-hero__dots .is-active {
  width: 12px;
  height: 12px;
  background-color: #ffb400;
}

/* ====== Register card (match register.html layout) ====== */
.register-card {
  position: absolute;
  right: 200px;
  top: 50%;
  transform: translateY(-50%);
  width: 420px;
  padding: 22px 24px 20px;
  background-color: rgba(255, 255, 255, 0.97);
  border-radius: 18px;
  box-shadow: 0 28px 60px rgba(0, 0, 0, 0.25);
  z-index: 4;
  backdrop-filter: blur(4px);
}
.register-card__tab {
  font-size: 24px;
  font-weight: 600;
  color: #cb261c;
  text-align: left;
  margin-bottom: 14px;
}

.reg-row {
  display: flex;
  gap: 12px;
  align-items: center;
}
.reg-row--split {
  align-items: flex-end;
}
.reg-field {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-bottom: 14px;
}
.reg-field--select {
  max-width: 120px;
}
.reg-label {
  font-size: 12px;
  color: #6b7280;
}

.reg-select {
  position: relative;
}
.reg-select select {
  appearance: none;
  width: 100%;
  height: 44px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  background: #ffffff;
  padding: 0 28px 0 12px;
  font-size: 14px;
  color: #111827;
  outline: none;
}
.reg-select select:focus {
  border-color: #cb261c;
  outline: none;
}
.reg-select__arrow {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  color: #6b7280;
  font-size: 12px;
  pointer-events: none;
}

.reg-input {
  width: 100%;
  height: 44px;
  border: 1px solid #e5e7eb;
  border-radius: 6px;
  background: #ffffff;
  padding: 0 12px;
  font-size: 14px;
  color: #111827;
  outline: none;
}

.reg-input-wrap {
  position: relative;
}
.reg-eye {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  border: none;
  background: transparent;
  padding: 0;
  width: 20px;
  height: 20px;
  cursor: pointer;
}
.reg-eye img {
  width: 18px;
  height: 18px;
}
.reg-input--with-eye {
  padding-left: 40px;
}

.reg-hint {
  font-size: 12px;
  color: #6b7280;
  margin-top: 6px;
  line-height: 1.4;
}

.reg-row--code {
  justify-content: space-between;
  gap: 12px;
  align-items: center;
  margin-bottom: 14px;
}
.reg-row--code .reg-input {
  flex: 1 1 auto;
  min-width: 0;
}
.reg-code {
  height: 44px;
  padding: 0 18px;
  border-radius: 6px;
  border: 1px solid #e5e7eb;
  background: #f9fafb;
  color: #1f2937;
  font-weight: 500;
  cursor: pointer;
  white-space: nowrap;
  flex-shrink: 0;
}
.reg-code:hover {
  background: #f3f4f6;
}
.reg-code:disabled {
  background: #e5e7eb;
  color: #9ca3af;
  cursor: not-allowed;
}

.reg-agree {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: #4b5563;
  line-height: 1.4;
  margin: 8px 0 6px;
}
.reg-agree a {
  color: #cb261c;
  text-decoration: none;
}
.reg-agree input[type='checkbox'] {
  width: 16px;
  height: 16px;
}
.reg-agree a:hover {
  text-decoration: underline;
}

.reg-submit {
  width: 100%;
  height: 46px;
  border-radius: 6px;
  font-weight: 600;
  letter-spacing: 0.6px;
  background: #cb261c;
  border: none;
  color: #fff;
  cursor: pointer;
  margin-top: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}
.reg-submit:hover {
  background: #b02118;
}
.reg-submit:disabled {
  background: #9ca3af;
  cursor: not-allowed;
  opacity: 0.6;
}

/* 加载动画 */
.btn-loading {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid #ffffff;
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

.reg-login {
  margin-top: 10px;
  font-size: 13px;
  color: #6b7280;
  display: flex;
  justify-content: center;
}
.reg-login a {
  color: #6b7280;
  text-decoration: none;
}
.reg-login a span {
  color: #cb261c;
  margin-left: 2px;
}

/* Footer 样式已移至 SiteFooter 组件 */
/* 注册页面Footer样式覆盖 */
:deep(footer) {
  background-color: #ffffff !important;
  color: #2d2d2d !important;
}

:deep(footer h3) {
  color: #1f2937 !important;
}

:deep(footer a) {
  color: #4b5563 !important;
}

:deep(footer a:hover) {
  color: #cb261c !important;
}

:deep(footer .text-slate-200),
:deep(footer .text-slate-300),
:deep(footer .text-slate-500) {
  color: #6b7280 !important;
}

:deep(footer .border-white\/10) {
  border-color: #e5e7eb !important;
}

@media (max-width: 1280px) {
  .login-container {
    width: 100%;
    padding: 0 24px;
  }
  .login-hero {
    height: 560px;
  }
  .register-card {
    right: 162px;
  }
}

/* transitions for carousel */
.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.6s ease;
}
.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}
</style>
