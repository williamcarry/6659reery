<template>
  <HelpLayout 
    page-title="å¸®åŠ©ä¸­å¿ƒ"
    sidebar-title="å¸¸è§é—®é¢˜"
    :nav-data="navData"
    :selected-sub-category="selectedSubCategory"
    :selected-sub-category-id="selectedSubCategoryId"
    :selected-category-name="selectedCategoryName"
    :paginated-questions="paginatedQuestions"
    :search-results="searchResults"
    :search-query="searchQuery"
    :current-page="currentPage"
    :total-pages="totalPages"
    :is-open="isOpen"
    :toggle="toggle"
    :on-select-sub-category="selectSubCategory"
    :get-faq-link="getFaqLink"
    :change-page="changePage"
    @search="handleSearch"
  >
    <template #content="{ selectedSubCategory, selectedCategoryName, paginatedQuestions, searchResults, searchQuery, getFaqLink, totalPages, currentPage, changePage }">
      <!-- æœç´¢åŠ è½½åŠ¨ç”»ï¼ˆåªåœ¨æœç´¢æ—¶æ˜¾ç¤ºï¼‰ -->
      <div v-if="searchLoading" class="search-loading">
        <div class="loading-spinner"></div>
        <p class="loading-text">æœç´¢ä¸­...</p>
      </div>
      
      <!-- é—®é¢˜è¯¦æƒ…åŒºåŸŸ -->
      <div v-else-if="selectedQuestion">
        <!-- é¢åŒ…å±‘å¯¼èˆª -->
        <div class="breadcrumb">
          <a href="/help-center" class="breadcrumb-link">å¸®åŠ©ä¸­å¿ƒ</a>
          <span class="breadcrumb-separator">></span>
          <a href="javascript:void(0)" class="breadcrumb-link" @click="backToQuestionList">{{ selectedCategoryName }}</a>
          <span class="breadcrumb-separator">></span>
          <a href="javascript:void(0)" class="breadcrumb-link" @click="backToQuestionList" v-if="selectedSubCategory">{{ selectedSubCategory.name }}</a>
          <span class="breadcrumb-separator" v-if="selectedSubCategory">></span>
          <span class="breadcrumb-current">{{ selectedQuestion.question }}</span>
        </div>
        
        <!-- é—®é¢˜è¯¦æƒ…å†…å®¹ -->
        <div class="question-detail-container">
          <div class="question-header">
            <h1 class="question-title">{{ selectedQuestion.question }}</h1>
            
            <div class="question-meta">
              <span class="meta-item">å‘å¸ƒæ—¶é—´ï¼š{{ selectedQuestion.createdAt }}</span>
              <span class="meta-item">æµè§ˆæ¬¡æ•°ï¼š{{ selectedQuestion.viewCount }}</span>
            </div>
          </div>
          
          <div class="question-content" v-html="selectedQuestion.content"></div>
          
          <!-- é—®é¢˜ç›¸å…³å›¾ç‰‡ -->
          <div v-if="selectedQuestion.images && selectedQuestion.images.length > 0" class="question-images">
            <div 
              v-for="(image, index) in selectedQuestion.images" 
              :key="index" 
              class="question-image-item"
            >
              <img :src="image" :alt="`é—®é¢˜å›¾ç‰‡${index + 1}`" class="question-image" @click="showImagePreview(image)" />
            </div>
          </div>
          
          <!-- åé¦ˆåŒºåŸŸ -->
          <div class="question-feedback">
            <p class="help-count">å·²å¸®åŠ© {{ selectedQuestion.solvedCount }} ä½ç”¨æˆ·è§£å†³é—®é¢˜</p>
            <div class="feedback-buttons">
              <button class="feedback-btn helpful" @click="markAsHelpful">
                <i class="feedback-icon">ğŸ‘</i>
                æœ‰å¸®åŠ©
              </button>
              <button class="feedback-btn not-helpful" @click="markAsNotHelpful">
                <i class="feedback-icon">âŒ</i>
                æœªè§£å†³
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div v-else-if="selectedSubCategory && selectedSubCategory.questions && selectedSubCategory.questions.length > 0">
        <h5 class="content-title">{{ selectedCategoryName }} {{ selectedSubCategory.name }}</h5>
        <div class="questions-container">
          <ul class="questions-list">
            <li v-for="(question, idx) in paginatedQuestions" :key="idx" class="question-item">
              <a href="javascript:void(0)" class="question-link" @click="showQuestionDetail(question)">{{ question.question }}</a>
            </li>
          </ul>
          <!-- åˆ†é¡µç»„ä»¶ï¼ˆåˆ†é¡µæ—¶ä¸æ˜¾ç¤ºåŠ¨ç”»ï¼‰ -->
          <Pagination 
            :current-page="currentPage"
            :total-pages="totalPages"
            :change-page="changePage"
          />
        </div>
      </div>
      <div v-else-if="searchResults.length > 0">
        <h5 class="content-title">æœç´¢ç»“æœ</h5>
        <div class="questions-container">
          <ul class="questions-list">
            <li v-for="(result, idx) in searchResults" :key="idx" class="question-item">
              <a href="javascript:void(0)" class="question-link" @click="showQuestionDetail(result)">{{ result.question }}</a>
            </li>
          </ul>
          <!-- æœç´¢ç»“æœåˆ†é¡µï¼ˆåˆ†é¡µæ—¶ä¸æ˜¾ç¤ºåŠ¨ç”»ï¼‰ -->
          <Pagination 
            :current-page="currentPage"
            :total-pages="totalPages"
            :change-page="changeSearchPage"
          />
        </div>
      </div>
      <div v-else class="questions-container">
        <p class="no-data">{{ searchQuery ? 'æœªæ‰¾åˆ°ç›¸å…³é—®é¢˜' : 'è¯·é€‰æ‹©ä¸€ä¸ªåˆ†ç±»æŸ¥çœ‹é—®é¢˜' }}</p>
      </div>
    </template>
  </HelpLayout>
  
  <!-- å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡† -->
  <div v-if="imagePreviewVisible" class="image-preview-modal" @click="closeImagePreview">
    <div class="image-preview-content" @click.stop>
      <span class="close-btn" @click="closeImagePreview">&times;</span>
      <img :src="previewImageUrl" class="preview-image" />
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import HelpLayout from '../layouts/HelpLayout.vue'
import Pagination from '../components/Pagination.vue'

const router = useRouter()

// å¤šè¯­è¨€é…ç½®
const translations = ref({})
const currentLang = ref('zh-CN')

// åŠ è½½ç¿»è¯‘æ–‡ä»¶
const loadTranslations = async () => {
  try {
    const response = await fetch('/frondend/lang/HelpCenterPage.json')
    const data = await response.json()
    translations.value = data
  } catch (error) {
    console.error('Failed to load translations:', error)
  }
}

// ç¿»è¯‘å‡½æ•°
const t = (key) => {
  const lang = localStorage.getItem('app.lang') || currentLang.value
  
  if (translations.value[lang] && translations.value[lang][key]) {
    return translations.value[lang][key]
  }
  
  return key
}

// æ›´æ–°é¡µé¢æ ‡é¢˜
const updatePageTitle = () => {
  const title = t('pageTitle')
  if (title && title !== 'pageTitle') {
    document.title = title
  }
}

// ç›‘å¬è¯­è¨€å˜åŒ–äº‹ä»¶
const handleLangChange = (event) => {
  if (event.detail && event.detail.lang) {
    currentLang.value = event.detail.lang
  }
  loadTranslations()
  updatePageTitle()
}

// æ–°å¢ï¼šä»APIè·å–çš„æ•°æ®
const faqCategories = ref([])
const loading = ref(false)
const error = ref(null)

// é€‰ä¸­çš„äºŒçº§åˆ†ç±»
const selectedSubCategory = ref(null)
const selectedSubCategoryId = ref(null)

// é€‰ä¸­çš„é—®é¢˜
const selectedQuestion = ref(null)

// æœç´¢ç›¸å…³
const searchQuery = ref('')
const searchResults = ref([])
const searchLoading = ref(false) // åªåœ¨æœç´¢æ—¶ä¸ºtrueï¼Œåˆ†é¡µæ—¶ä¸ä¸ºtrue

// åˆ†é¡µç›¸å…³
const currentPage = ref(1)
const totalPages = ref(0)
const totalQuestions = ref(0)
const questionsPerPage = ref(10)
const paginatedQuestions = ref([])

// å›¾ç‰‡é¢„è§ˆç›¸å…³
const imagePreviewVisible = ref(false)
const previewImageUrl = ref('')

// è·å–ä¸€çº§åˆ†ç±»åç§°
const selectedCategoryName = computed(() => {
  if (!selectedSubCategory.value) return ''
  const categoryId = selectedSubCategory.value.categoryId || selectedSubCategory.value.parentId
  const category = faqCategories.value.find(c => c.id == categoryId)
  return category ? category.name : ''
})

// è·å–FAQåˆ†ç±»æ•°æ®
const fetchFaqCategories = async () => {
  try {
    loading.value = true
    error.value = null
    const response = await fetch('/shop/api/help/faq-categories')
    const result = await response.json()
    
    if (result.success) {
      faqCategories.value = result.data
      
      // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªäºŒçº§åˆ†ç±»ï¼ˆå¦‚æœæœ‰ï¼‰
      if (result.data.length > 0 && result.data[0].children && result.data[0].children.length > 0) {
        selectSubCategory(result.data[0].children[0])
        // é»˜è®¤å±•å¼€ç¬¬ä¸€ä¸ªä¸€çº§åˆ†ç±»
        openKeys.value = new Set([result.data[0].id])
      }
    } else {
      error.value = result.message || 'è·å–åˆ†ç±»æ•°æ®å¤±è´¥'
    }
  } catch (err) {
    error.value = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'
    console.error('è·å–åˆ†ç±»æ•°æ®å¤±è´¥:', err)
  } finally {
    loading.value = false
  }
}

// å±•å¼€æŠ˜å çŠ¶æ€ - ä¸€çº§åˆ†ç±»ï¼ˆä¸€æ¬¡åªå±•å¼€ä¸€ä¸ªï¼‰
const openKeys = ref(new Set())
function isOpen(key) {
  return openKeys.value.has(key)
}
function toggle(key) {
  // ä¸€æ¬¡åªå±•å¼€ä¸€ä¸ªä¸€çº§åˆ†ç±»
  if (openKeys.value.has(key)) {
    // å¦‚æœå½“å‰åˆ†ç±»å·²å±•å¼€ï¼Œåˆ™å…³é—­å®ƒ
    openKeys.value = new Set()
  } else {
    // å¦‚æœå½“å‰åˆ†ç±»æœªå±•å¼€ï¼Œåˆ™å…³é—­å…¶ä»–æ‰€æœ‰åˆ†ç±»ï¼Œåªå±•å¼€å½“å‰åˆ†ç±»
    openKeys.value = new Set([key])
  }
}

// å¯¼èˆªæ•°æ®ï¼ˆæ¥è‡ªAPIï¼‰
const navData = computed(() => {
  return faqCategories.value
})

// é€‰æ‹©äºŒçº§åˆ†ç±»
async function selectSubCategory(subCategory) {
  selectedSubCategory.value = subCategory
  selectedSubCategoryId.value = subCategory.id
  searchQuery.value = ''
  searchResults.value = []
  selectedQuestion.value = null // æ¸…é™¤é€‰ä¸­çš„é—®é¢˜
  
  // é‡ç½®åˆ†é¡µ
  currentPage.value = 1
  
  // è·å–åˆ†é¡µæ•°æ®
  await fetchQuestionsWithPagination(subCategory.id)
  
  // æ»šåŠ¨åˆ°åˆ—è¡¨é¡¶éƒ¨
  if (typeof window !== 'undefined') {
    window.scrollTo({ top: 0, behavior: 'smooth' })
  }
}

// è·å–åˆ†é¡µé—®é¢˜æ•°æ®ï¼ˆåˆ†é¡µæ—¶ä¸æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
async function fetchQuestionsWithPagination(subCategoryId) {
  try {
    loading.value = true
    const response = await fetch(`/shop/api/help/faq-questions/${subCategoryId}?page=${currentPage.value}&limit=${questionsPerPage.value}`)
    const result = await response.json()
    
    if (result.success) {
      paginatedQuestions.value = result.data.questions
      totalQuestions.value = result.data.total
      totalPages.value = result.data.pages
    }
  } catch (err) {
    error.value = 'è·å–é—®é¢˜åˆ—è¡¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
    console.error('è·å–é—®é¢˜åˆ—è¡¨å¤±è´¥:', err)
  } finally {
    loading.value = false
  }
}

// åˆ‡æ¢é¡µé¢ï¼ˆåˆ†é¡µæ—¶ä¸æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
function changePage(page) {
  if (page < 1 || page > totalPages.value || page === currentPage.value) return
  currentPage.value = page
  fetchQuestionsWithPagination(selectedSubCategoryId.value)
}

// æœç´¢åŠŸèƒ½ï¼ˆåªåœ¨æœç´¢æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
async function handleSearch(query) {
  searchQuery.value = query
  if (!query.trim()) return
  
  try {
    searchLoading.value = true // åªåœ¨æœç´¢æ—¶è®¾ç½®ä¸ºtrue
    searchResults.value = []
    selectedQuestion.value = null // æ¸…é™¤é€‰ä¸­çš„é—®é¢˜
    currentPage.value = 1
    
    const response = await fetch(`/shop/api/help/search?keyword=${encodeURIComponent(query)}&page=1&limit=${questionsPerPage.value}`)
    const result = await response.json()
    
    if (result.success) {
      // å¤„ç†æœç´¢ç»“æœ
      searchResults.value = result.data.results
      totalPages.value = result.data.pages
      selectedSubCategory.value = null
      selectedSubCategoryId.value = null
    }
  } catch (err) {
    error.value = 'æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
    console.error('æœç´¢å¤±è´¥:', err)
  } finally {
    searchLoading.value = false // æœç´¢å®Œæˆåè®¾ç½®ä¸ºfalse
  }
}

// æœç´¢ç»“æœåˆ†é¡µï¼ˆåˆ†é¡µæ—¶ä¸æ˜¾ç¤ºåŠ è½½åŠ¨ç”»ï¼‰
async function changeSearchPage(page) {
  if (page < 1 || page > totalPages.value || page === currentPage.value) return
  currentPage.value = page
  
  try {
    // åˆ†é¡µæ—¶ä¸æ˜¾ç¤ºæœç´¢åŠ è½½åŠ¨ç”»ï¼Œä½¿ç”¨æ™®é€šåŠ è½½çŠ¶æ€
    loading.value = true
    const response = await fetch(`/shop/api/help/search?keyword=${encodeURIComponent(searchQuery.value)}&page=${page}&limit=${questionsPerPage.value}`)
    const result = await response.json()
    
    if (result.success) {
      searchResults.value = result.data.results
      totalPages.value = result.data.pages
    }
  } catch (err) {
    error.value = 'æœç´¢å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
    console.error('æœç´¢å¤±è´¥:', err)
  } finally {
    loading.value = false
  }
}

// æ˜¾ç¤ºé—®é¢˜è¯¦æƒ…
async function showQuestionDetail(question) {
  try {
    const response = await fetch(`/shop/api/help/question/${question.id}`)
    const result = await response.json()
    
    if (result.success) {
      selectedQuestion.value = result.data
      // æ»šåŠ¨åˆ°é¡¶éƒ¨
      window.scrollTo({ top: 0, behavior: 'smooth' })
    } else {
      error.value = result.message || 'è·å–é—®é¢˜è¯¦æƒ…å¤±è´¥'
    }
  } catch (err) {
    error.value = 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'
    console.error('è·å–é—®é¢˜è¯¦æƒ…å¤±è´¥:', err)
  }
}

// è¿”å›é—®é¢˜åˆ—è¡¨
function backToQuestionList() {
  selectedQuestion.value = null
}

// æ ‡è®°ä¸ºæœ‰å¸®åŠ©
async function markAsHelpful() {
  try {
    const response = await fetch(`/shop/api/help/question/${selectedQuestion.value.id}/solved`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    });
    const result = await response.json();
    
    if (result.success) {
      selectedQuestion.value.solvedCount += 1;
      // æ˜¾ç¤ºæç¤ºä¿¡æ¯
      alert('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼');
    } else {
      alert('åé¦ˆæäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
    }
  } catch (err) {
    console.error('æ ‡è®°ä¸ºæœ‰å¸®åŠ©å¤±è´¥:', err);
    alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
  }
}

// æ ‡è®°ä¸ºæœªè§£å†³
function markAsNotHelpful() {
  // æ˜¾ç¤ºæç¤ºä¿¡æ¯
  alert('æ„Ÿè°¢ä½ åé¦ˆ')
  // ä¸æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œåœç•™åœ¨å½“å‰é¡µé¢
}

// æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
function showImagePreview(url) {
  previewImageUrl.value = url
  imagePreviewVisible.value = true
}

// å…³é—­å›¾ç‰‡é¢„è§ˆ
function closeImagePreview() {
  imagePreviewVisible.value = false
  previewImageUrl.value = ''
}


// ç»„ä»¶æŒ‚è½½æ—¶è·å–æ•°æ®
onMounted(() => {
  // åŠ è½½ç¿»è¯‘
  loadTranslations().then(() => {
    updatePageTitle()
  })
  
  // ç›‘å¬è¯­è¨€å˜åŒ–
  window.addEventListener('languagechange', handleLangChange)
  
  fetchFaqCategories().then(() => {
    // æ£€æŸ¥URLå‚æ•°ä¸­æ˜¯å¦æœ‰faqid
    const urlParams = new URLSearchParams(window.location.search)
    const faqId = urlParams.get('faqid')
    if (faqId) {
      // å»¶è¿Ÿæ‰§è¡Œä»¥ç¡®ä¿åˆ†ç±»æ•°æ®å·²åŠ è½½
      setTimeout(() => {
        showQuestionDetailById(faqId)
      }, 100)
    }
  })
})

// æ ¹æ®FAQ IDæ˜¾ç¤ºé—®é¢˜è¯¦æƒ…
async function showQuestionDetailById(faqId) {
  try {
    // é¦–å…ˆå°è¯•ä»APIè·å–é—®é¢˜è¯¦æƒ…
    const response = await fetch(`/shop/api/help/question/${faqId}`)
    const result = await response.json()
    
    if (result.success) {
      const question = result.data
      
      // è®¾ç½®é€‰ä¸­çš„é—®é¢˜
      selectedQuestion.value = question
      
      // æŸ¥æ‰¾å¹¶å±•å¼€å¯¹åº”çš„åˆ†ç±»
      const categoryId = question.subCategoryId
      if (categoryId) {
        // æŸ¥æ‰¾å¯¹åº”çš„äºŒçº§åˆ†ç±»
        for (const category of faqCategories.value) {
          if (category.children) {
            const subCategory = category.children.find(child => child.id == categoryId)
            if (subCategory) {
              // é€‰ä¸­äºŒçº§åˆ†ç±»
              selectedSubCategory.value = subCategory
              selectedSubCategoryId.value = subCategory.id
              // å±•å¼€ä¸€çº§åˆ†ç±»
              openKeys.value = new Set([category.id])
              break
            }
          }
        }
      }
      
      // æ»šåŠ¨åˆ°é¡¶éƒ¨
      window.scrollTo({ top: 0, behavior: 'smooth' })
    }
  } catch (err) {
    console.error('è·å–é—®é¢˜è¯¦æƒ…å¤±è´¥:', err)

  }
}

</script>

<style scoped>
.content-title {
  color: #333;
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 16px;
}

.questions-container {
  margin-bottom: 40px;
}

.no-data {
  color: #333;
  font-size: 16px;
  margin-bottom: 4px;
}

.questions-list {
  margin-left: 30px;
  padding: 0;
}

.question-item {
  list-style: disc;
  color: #999;
}

.question-link {
  color: #333;
  text-decoration: none;
  line-height: 36px;
}

/* æœç´¢åŠ è½½åŠ¨ç”»æ ·å¼ */
.search-loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #cb261c;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-text {
  color: #666;
  font-size: 16px;
  margin: 0;
}

/* é¢åŒ…å±‘å¯¼èˆªæ ·å¼ */
.breadcrumb {
  padding: 15px 0;
  margin-bottom: 20px;
  border-bottom: 1px solid #eee;
  font-size: 14px;
  background-color: #f8f9fa;
  padding-left: 20px;
  border-radius: 4px;
}

.breadcrumb-link {
  color: #007bff;
  text-decoration: none;
  transition: color 0.3s;
  font-weight: 500;
}

.breadcrumb-link:hover {
  color: #0056b3;
  text-decoration: underline;
}

.breadcrumb-separator {
  margin: 0 8px;
  color: #6c757d;
}

.breadcrumb-current {
  color: #495057;
  font-weight: 500;
}

/* é—®é¢˜è¯¦æƒ…å®¹å™¨ */
.question-detail-container {
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: 30px;
  margin-bottom: 30px;
}

.question-header {
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid #eee;
}

.question-title {
  font-size: 28px;
  font-weight: 700;
  color: #212529;
  margin-bottom: 20px;
  line-height: 1.3;
  text-align: center;
}

.question-meta {
  text-align: center;
  color: #6c757d;
  font-size: 14px;
}

.meta-item {
  margin: 0 15px;
}

.question-content {
  font-size: 16px;
  line-height: 1.8;
  color: #333;
  margin-bottom: 40px;
}

.question-content :deep(img) {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  margin: 15px 0;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
}

.question-content :deep(p) {
  margin-bottom: 16px;
  text-align: justify;
}

.question-content :deep(h1),
.question-content :deep(h2),
.question-content :deep(h3) {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 700;
  color: #212529;
}

.question-content :deep(h1) {
  font-size: 24px;
  border-bottom: 2px solid #007bff;
  padding-bottom: 10px;
}

.question-content :deep(h2) {
  font-size: 20px;
  border-bottom: 1px solid #dee2e6;
  padding-bottom: 8px;
}

.question-content :deep(h3) {
  font-size: 18px;
}

.question-content :deep(ul),
.question-content :deep(ol) {
  margin-left: 20px;
  margin-bottom: 16px;
}

.question-content :deep(li) {
  margin-bottom: 8px;
}

.question-content :deep(code) {
  background-color: #f8f9fa;
  padding: 2px 6px;
  border-radius: 3px;
  font-family: monospace;
  font-size: 14px;
}

.question-content :deep(pre) {
  background-color: #f8f9fa;
  padding: 15px;
  border-radius: 5px;
  overflow-x: auto;
  margin: 20px 0;
}

.question-content :deep(blockquote) {
  border-left: 4px solid #007bff;
  padding: 10px 20px;
  margin: 20px 0;
  background-color: #f8f9fa;
  color: #6c757d;
}

/* é—®é¢˜å›¾ç‰‡æ ·å¼ */
.question-images {
  margin-top: 30px;
  margin-bottom: 30px;
  width: 100%;
}

.question-image-item {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  margin-bottom: 20px;
}

.question-image {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s ease;
}

.question-image:hover {
  transform: scale(1.02);
}

/* å›¾ç‰‡é¢„è§ˆæ¨¡æ€æ¡†æ ·å¼ */
.image-preview-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.image-preview-content {
  position: relative;
  max-width: 90%;
  max-height: 90%;
}

.close-btn {
  position: absolute;
  top: -40px;
  right: 0;
  font-size: 30px;
  color: white;
  cursor: pointer;
  background: none;
  border: none;
}

.preview-image {
  max-width: 100%;
  max-height: 80vh;
  border-radius: 4px;
}

/* åé¦ˆåŒºåŸŸæ ·å¼ */
.question-feedback {
  text-align: center;
  padding: 30px 0 20px;
  border-top: 1px solid #eee;
  margin-top: 30px;
}

.help-count {
  color: #6c757d;
  font-size: 14px;
  margin-bottom: 20px;
}

.feedback-buttons {
  display: flex;
  justify-content: center;
  gap: 30px;
  margin-top: 10px;
}

.feedback-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  border: 1px solid #ddd;
  background: #fff;
  border-radius: 30px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 500;
  transition: all 0.3s;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.feedback-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.feedback-icon {
  font-size: 18px;
}

.helpful:hover {
  border-color: #28a745;
  color: #28a745;
}

.not-helpful:hover {
  border-color: #dc3545;
  color: #dc3545;
}
</style>